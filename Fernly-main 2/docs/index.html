<!DOCTYPE html>
<html lang="en">
<!-- 
GitHub Pages Redeploy Fix: This comment was added to force GitHub Pages to redeploy 
and properly serve all files including ai.js. The deployment should be configured 
with GitHub Pages source set to /docs directory.
Date: December 2024
-->

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fernly Health - Mental Wellness Reimagined</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <!-- AOS (Animate On Scroll) Library -->
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
  <!-- SMART AI SYSTEM - BROWSER-COMPATIBLE INTELLIGENT RESPONSES -->
  <!-- Reliable pattern-based AI with comprehensive mental health knowledge -->
  <!-- No external dependencies - works perfectly with static hosting -->
  <!-- License: Custom implementation - Suitable for commercial use -->
  <!-- Benefits: Fast loading, reliable operation, contextual responses, offline capable -->
  <!-- Fallback data must load before AI chat functionality -->
  <script src="fallback-data.js" onerror="console.warn('Fallback data failed to load - AI chat may have limited functionality')"></script>
  <!-- Basic DSM-5 disorder summaries -->
  <script src="dsm5-data.js" onerror="console.warn('DSM-5 data failed to load - mental health information may be limited')"></script>
  <script src="medications-data.js" onerror="console.warn('Medications data failed to load - medication information may be limited')"></script>
  <script src="therapy-speech.js" onerror="console.warn('Therapy speech data failed to load - therapeutic responses may be limited')"></script>
  <!-- AI Chat functionality -->
  <script src="ai.js" onerror="console.warn('AI chat functionality failed to load - chat feature may not work')"></script>
  <!-- Dependencies checking script for AI data files -->
  <script>
    (function(){
      const status = document.getElementById('aiAIStatus');
      
      // Check if required dependencies are loaded
      function checkDependencies() {
        const missingDeps = [];
        if (!window.fallbackData) missingDeps.push('fallback-data.js');
        if (!window.dsm5Data) missingDeps.push('dsm5-data.js');
        if (!window.medicationsData) missingDeps.push('medications-data.js');
        if (!window.therapySpeechData) missingDeps.push('therapy-speech.js');
        
        if (missingDeps.length > 0 && status) {
          status.innerText = `Some resources failed to load: ${missingDeps.join(', ')}. AI chat may have limited functionality.`;
          status.style.color = '#ff6b35';
        }
      }
      
      // Check dependencies when page loads
      window.addEventListener('load', checkDependencies);
    })();
  </script>
  <!-- CSS STYLES WILL GO HERE -->
  <style>
    :root {
      --scroll-duration: 14s;
      --slot-width: 140px;
      --slot-height: 55px;
      --g1: #8fbf8f;
      --g2: #9ac99a;
      --g3: #a6d3a6;
      --g4: #b1dcb1;
      --g5: #add9c5;
      --g6: #e8c864;
      
      /* Stepper component colors */
      --stepper-primary: #619251;
      --stepper-primary-hover: #4F7942;
      --stepper-secondary: #8fbf8f;
      --stepper-accent: #e8c864;
      --stepper-text: #333;
      --stepper-text-light: #666;
      --stepper-background: rgba(255, 255, 255, 0.95);
      --stepper-border: rgba(255, 255, 255, 0.2);
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      font-family: 'Poppins', sans-serif;
      color: #333;
    }

    h1,
    h2 {
      font-family: 'Playfair Display', serif;
    }

    body {
      background-color: #8fbf8f;
      background: linear-gradient(
          45deg,
          var(--g1) 0%,
          var(--g2) 15%,
          var(--g3) 30%,
          var(--g4) 45%,
          var(--g5) 60%,
          var(--g6) 100%
      );
      background-size: 600% 600%;
      animation: moodShift 12s ease-in-out infinite;
      background-attachment: fixed;
      will-change: background;
      margin: 0;
      padding: 0;
      overflow-x: hidden; /* Prevent horizontal scrolling */
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAATElEQVR4nAXBMREAIQwEwPu3QIEHylOBBVykijRmkBAJKaBLGQU07KL3TjOjqjIi+K21eO9FKQVzTvzujtYaMhNjDOCcQxHh3pu1Vj4teh4idyTiKwAAAABJRU5ErkJggg==");
      background-size: 8px 8px;
      opacity: .02;
      pointer-events: none;
    }

    /* Ensure seamless gradient across all sections */
    section,
    footer {
      background: inherit;
      background-size: inherit;
      animation: inherit;
    }

    section {
      margin: 0;
      padding: 6rem 0;
    }



    @keyframes moodShift {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }


    a {
      text-decoration: none;
      color: inherit;
    }

    .container {
      width: 90%;
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Loading Screen */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
          45deg,
          var(--g1) 0%,
          var(--g2) 15%,
          var(--g3) 30%,
          var(--g4) 45%,
          var(--g5) 60%,
          var(--g6) 100%
      );
      background-size: 600% 600%;
      animation: moodShift 12s ease-in-out infinite;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 1s ease, visibility 1s ease;
    }

    .loading-screen.fade-out {
      opacity: 0;
      visibility: hidden;
    }

    .loading-content {
      text-align: center;
      color: white;
    }

    .loading-text {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 1rem;
      opacity: 0;
      animation: fadeInUp 1s ease forwards;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      transition: all 0.3s ease;
    }

    nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 0;
    }

    .logo {
      display: flex;
      align-items: center;
    }

    .logo img {
      height: 40px;
      margin-right: 0.75rem;
      opacity: 0;
      transform: translateY(-50px) rotate(-15deg);
    }

    .logo.start-animation img {
      animation: leafDrop 2s ease-out forwards;
      animation-delay: 0.5s;
    }

    @keyframes leafDrop {
      0% {
        opacity: 0;
        transform: translateY(-50px) rotate(-15deg);
      }
      30% {
        opacity: 0.3;
        transform: translateY(-30px) rotate(-10deg);
      }
      60% {
        opacity: 0.7;
        transform: translateY(-10px) rotate(-5deg);
      }
      80% {
        opacity: 0.9;
        transform: translateY(-2px) rotate(-2deg);
      }
      100% {
        opacity: 1;
        transform: translateY(0) rotate(0deg);
      }
    }

    .logo span {
      font-size: 1.5rem;
      font-weight: 700;
      color: #4F7942;
      opacity: 0;
      transform: translateY(20px);
    }

    .logo.start-animation span {
      animation: fadeInUp 0.8s ease forwards;
      animation-delay: 2.5s;
    }

    .nav-links {
      list-style: none;
      display: flex;
      gap: 2rem;
      align-items: center;
    }

    .nav-links a {
      font-weight: 500;
      transition: color 0.3s ease;
      position: relative;
    }

    .nav-links a:hover {
      color: #619251;
    }

    .nav-links a::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -5px;
      left: 0;
      background-color: #619251;
      transition: width 0.3s ease;
    }

    .nav-links a:hover::after {
      width: 100%;
    }

    /* ORIGINAL WORKING BUTTON STYLES */
    .btn-primary {
      background: #619251;
      color: #fff;
      padding: 0.75rem 1.5rem;
      border-radius: 25px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: 2px solid #619251;
    }

    .btn-primary:hover {
      background: transparent;
      color: #619251;
      transform: translateY(-2px) scale(1.03);
    }

    .btn-secondary {
      background: transparent;
      color: #fff;
      padding: 0.75rem 1.5rem;
      border-radius: 25px;
      font-weight: 600;
      border: 2px solid #fff;
      transition: all 0.3s ease;
    }

    .btn-secondary:hover {
      background: #fff;
      color: #333;
      transform: translateY(-2px) scale(1.03);
    }

    /* AI Chat Button */
    .btn-ai {
      background: linear-gradient(135deg, #619251, #4F7942);
      color: #fff;
      padding: 0.75rem 1.5rem;
      border-radius: 25px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .btn-ai:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 8px 25px rgba(97, 146, 81, 0.4);
    }

    .btn-ai::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .btn-ai:hover::before {
      left: 100%;
    }

    .hero {
      text-align: center;
      padding: 8rem 1rem 4rem;
      color: #fff;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .hero h1 {
      font-size: 3.5rem;
      margin-bottom: 1rem;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);
      font-weight: 700;
    }

    .hero .tagline {
      font-size: 1.3rem;
      max-width: 700px;
      margin: 0 auto 2rem;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);
      font-weight: 300;
      opacity: 0;
      transform: translateY(20px);
      transition: all 1.2s ease;
    }

    .hero .tagline.show {
      opacity: 1;
      transform: translateY(0);
    }

    .hero h1 .word {
      display: inline-block;
      opacity: 0;
      animation: smoothRise 0.9s ease-out forwards;
      animation-play-state: paused; /* Triggered via JavaScript */
    }

    .hero h1 .word:nth-child(1) { animation-delay: 0s; }
    .hero h1 .word:nth-child(2) { animation-delay: 0.9s; }
    .hero h1 .word:nth-child(3) { animation-delay: 1.8s; }

    @keyframes smoothRise {
      0% {
        opacity: 0;
        transform: translateY(30px) scale(0.96);
        filter: blur(3px);
      }
      60% {
        opacity: 1;
        transform: translateY(-4px) scale(1.02);
        filter: blur(0px);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .hero-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    /* AI Chat Section Styles */
    #ai-chat {
      padding: 6rem 0; /* Reduced from 8rem to 6rem */
      background: transparent;
    }

    .chat-intro {
      text-align: center;
      color: #fff;
      font-size: 1.1rem;
      margin-bottom: 3rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
    }

    .chat-interface {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }

    /* AI Status Indicator */
    .ai-status-indicator {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 8px 16px;
      font-size: 0.9em;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .ai-status-indicator.loading {
      background: linear-gradient(135deg, #ffa726 0%, #ff7043 100%);
    }

    .ai-status-indicator.ai-active {
      background: linear-gradient(135deg, #66bb6a 0%, #43a047 100%);
    }

    .ai-status-indicator.fallback-active {
      background: linear-gradient(135deg, #42a5f5 0%, #1e88e5 100%);
    }

    .ai-status-indicator.error {
      background: linear-gradient(135deg, #ef5350 0%, #d32f2f 100%);
    }

    .status-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .status-icon {
      font-size: 1.1em;
    }

    .status-text {
      font-weight: 500;
    }

    .chat-messages {
      height: 400px;
      overflow-y: auto;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      background: #f8f9fa;
    }

    .message {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
    }

    .message.user {
      flex-direction: row-reverse;
    }

    .message-content {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      max-width: 80%;
    }

    .message.user .message-content {
      flex-direction: row-reverse;
    }


    .message-text {
      background: white;
      padding: 1rem 1.5rem;
      border-radius: 18px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      line-height: 1.5;
      color: #333;
    }

    .message.user .message-text {
      background: #619251;
      color: white;
    }

    /* Error notification styling */
    .message.error-notification .message-text {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      color: #856404;
    }


    /* Fallback mode styling - subtle indicator */
    .message.fallback-response .message-text {
      background: #f8f9ff;
      border-left: 3px solid #42a5f5;
    }

    .message.fallback-response .message-text::after {
      content: "🛡️";
      float: right;
      opacity: 0.3;
      font-size: 0.8em;
      margin-left: 10px;
    }

    .chat-input-area {
      padding: 1.5rem;
      background: white;
      border-top: 1px solid #eee;
    }

    .input-container {
      display: flex;
      align-items: flex-end;
      gap: 0.75rem;
      background: #f8f9fa;
      border-radius: 25px;
      padding: 0.75rem;
      border: 2px solid transparent;
      transition: border-color 0.3s ease;
    }

    .input-container:focus-within {
      border-color: #619251;
    }

    .chat-input {
      flex: 1;
      border: none;
      background: transparent;
      resize: none;
      font-family: inherit;
      font-size: 1rem;
      line-height: 1.5;
      max-height: 120px;
      min-height: 24px;
      outline: none;
    }

    .chat-send {
      background: #619251;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .chat-send:hover {
      background: #4F7942;
      transform: scale(1.05);
    }

    .chat-send:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .disclaimer {
      font-size: 0.7rem; /* smaller for less visual weight */
      color: #777;       /* softer gray tone */
      text-align: center;
      margin-top: 1rem;
      line-height: 1.4;
    }


    /* Medical Disclaimer - NEW */
    .medical-disclaimer {
      background: rgba(219, 54, 69, 0.05); /* lighter background */
      border-left: 3px solid #db3645;
      padding: 0.8rem 1rem;
      margin-top: 0.5rem;
      border-radius: 8px;
      font-size: 0.75rem;  /* slightly smaller */
      line-height: 1.4;
      color: #555;        /* grey tone */
    }

    /* Medication Info Style - NEW */
    .medication-info {
      background: rgba(97, 146, 81, 0.1);
      border: 1px solid #619251;
      border-radius: 8px;
      padding: 12px;
      margin: 10px 0;
    }

    .medication-info h4 {
      color: #4F7942;
      margin-bottom: 8px;
    }

    .medication-info ul {
      margin: 8px 0;
      padding-left: 20px;
    }

    .medication-info .med-disclaimer {
      font-style: italic;
      font-size: 0.9em;
      margin-top: 8px;
      color: #666;
    }

    .medication-info .verify-link {
      display: inline-block;
      margin-top: 8px;
      color: #4F7942;
      font-weight: 600;
    }

    /* Wellness Assessment Style - NEW */
    .wellness-assessment {
      background: rgba(255, 255, 255, 0.8);
      border-radius: 12px;
      padding: 15px;
      margin-top: 15px;
    }

    .wellness-assessment h4 {
      color: #4F7942;
      margin-bottom: 10px;
    }

    .wellness-assessment .assessment-areas {
      margin: 10px 0;
    }

    .wellness-assessment .area-item {
      background: #f0f8f1;
      border-left: 3px solid #619251;
      padding: 8px 12px;
      margin-bottom: 8px;
      border-radius: 4px;
    }

    .wellness-assessment .assessment-note {
      font-style: italic;
      margin-top: 12px;
      font-size: 0.9em;
      color: #666;
    }

    .wellness-assessment .assessment-action {
      margin-top: 12px;
      font-weight: 600;
      color: #4F7942;
    }

    /* Typing indicator for the new chat interface */
    .typing-indicator {
      display: flex;
      gap: 4px;
      padding: 1rem 1.5rem;
      background: white;
      border-radius: 18px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      width: fit-content;
    }

    .typing-indicator span {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: #619251;
      animation: typing 1.4s infinite ease-in-out;
    }

    .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
    .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }

    @keyframes typing {
      0%, 80%, 100% {
        transform: scale(0.8);
        opacity: 0.5;
      }
      40% {
        transform: scale(1);
        opacity: 1;
      }
    }

    /* Resource Card - NEW */
    .resource-card {
      background: #f8f9fa;
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      padding: 1rem;
      margin: 0.5rem 0;
      transition: box-shadow 0.3s ease, transform 0.3s ease;
    }

    .resource-card:hover {
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
      transform: translateY(-8px) scale(1.03);
    }
    
    .resource-card h4 {
      color: #4F7942;
      margin-bottom: 0.5rem;
    }
    
    .resource-links {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    
    .resource-link {
      background: #e7f1e8;
      color: #4F7942;
      padding: 0.3rem 0.6rem;
      border-radius: 15px;
      font-size: 0.8rem;
      transition: all 0.2s ease;
    }
    
    .resource-link:hover {
      background: #4F7942;
      color: white;
    }

    /* How It Works Stepper Component */
    #how-it-works {
      padding: 6rem 0;
      background: transparent;
    }

    .stepper-nav {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 3rem;
      flex-wrap: wrap;
    }

    .stepper-nav__item {
      background: var(--stepper-background);
      border: 2px solid var(--stepper-border);
      border-radius: 15px;
      padding: 1rem 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      color: var(--stepper-text);
      font-family: 'Poppins', sans-serif;
      font-weight: 500;
      text-decoration: none;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    .stepper-nav__item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      background: rgba(255, 255, 255, 1);
    }

    .stepper-nav__item--active {
      background: var(--stepper-primary);
      color: white;
      border-color: var(--stepper-primary);
    }

    .stepper-nav__item--active:hover {
      background: var(--stepper-primary-hover);
      border-color: var(--stepper-primary-hover);
    }

    .stepper-nav__number {
      background: var(--stepper-accent);
      color: var(--stepper-text);
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.9rem;
      flex-shrink: 0;
    }

    .stepper-nav__item--active .stepper-nav__number {
      background: rgba(255, 255, 255, 0.2);
      color: white;
    }

    .stepper-nav__label {
      font-size: 0.95rem;
      white-space: nowrap;
    }

    .stepper-content {
      max-width: 800px;
      margin: 0 auto;
      position: relative;
      min-height: 250px;
    }

    .stepper-content__panel {
      background: var(--stepper-background);
      border-radius: 20px;
      padding: 3rem;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      text-align: center;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.4s ease;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      visibility: hidden;
    }

    .stepper-content__panel--active {
      opacity: 1;
      transform: translateY(0);
      visibility: visible;
      position: relative;
    }

    .stepper-content__title {
      font-family: 'Playfair Display', serif;
      font-size: 2rem;
      color: var(--stepper-text);
      margin-bottom: 1.5rem;
      font-weight: 700;
    }

    .stepper-content__text {
      font-size: 1.1rem;
      line-height: 1.7;
      color: var(--stepper-text-light);
      margin-bottom: 2rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .stepper-content__cta {
      display: inline-block;
      background: var(--stepper-primary);
      color: white;
      padding: 1rem 2rem;
      border-radius: 25px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(97, 146, 81, 0.3);
    }

    .stepper-content__cta:hover {
      background: var(--stepper-primary-hover);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(97, 146, 81, 0.4);
    }

    /* Mobile responsive design */
    @media (max-width: 768px) {
      .stepper-nav {
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
      }

      .stepper-nav__item {
        width: 100%;
        max-width: 320px;
        justify-content: center;
      }

      .stepper-content__panel {
        padding: 2rem 1.5rem;
      }

      .stepper-content__title {
        font-size: 1.5rem;
      }

      .stepper-content__text {
        font-size: 1rem;
      }
    }

    @media (max-width: 480px) {
      .stepper-nav__label {
        font-size: 0.9rem;
      }

      .stepper-nav__item {
        padding: 0.75rem 1rem;
      }

      .stepper-content__panel {
        padding: 1.5rem 1rem;
      }
    }

    /* Chat Bubble Component */
    .chat-bubble {
      position: fixed;
      bottom: 20px;
      left: 20px;
      max-width: 280px;
      background: var(--stepper-background);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      padding: 1.5rem;
      transform: translateY(100px);
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s ease;
      z-index: 1000;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .chat-bubble--visible {
      transform: translateY(0);
      opacity: 1;
      visibility: visible;
    }

    .chat-bubble__content {
      margin-bottom: 1rem;
    }

    .chat-bubble__text {
      font-size: 1rem;
      color: var(--stepper-text);
      font-weight: 500;
      margin-bottom: 1rem;
      line-height: 1.4;
    }

    .chat-bubble__actions {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .chat-bubble__link {
      background: var(--stepper-primary);
      color: white;
      padding: 0.75rem 1rem;
      border-radius: 10px;
      text-decoration: none;
      font-weight: 500;
      font-size: 0.9rem;
      text-align: center;
      transition: all 0.3s ease;
    }

    .chat-bubble__link:hover {
      background: var(--stepper-primary-hover);
      transform: translateY(-1px);
    }

    .chat-bubble__close {
      position: absolute;
      top: 8px;
      right: 12px;
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--stepper-text-light);
      cursor: pointer;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .chat-bubble__close:hover {
      background: rgba(0, 0, 0, 0.1);
      color: var(--stepper-text);
    }

    /* Mobile adjustments for chat bubble */
    @media (max-width: 768px) {
      .chat-bubble {
        bottom: 15px;
        left: 15px;
        right: 15px;
        max-width: none;
        width: calc(100% - 30px);
      }
    }

    /* Blank section placeholder */
    .blank-section {
      height: 30vh; /* Reduced from 50vh to 30vh */
      background: transparent;
    }

    #blog {
      padding: 6rem 0;
      background: transparent;
    }

    .section-title {
      text-align: center;
      color: #fff;
      font-size: 2.5rem;
      margin-bottom: 3rem;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);
    }


    .blog-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 2rem;
      margin-top: 3rem;
    }

    .resource-description {
      color: #fff;
      text-align: center;
      margin: 1rem auto 2rem;
      max-width: 800px;
      line-height: 1.6;
    }

    .blog-date {
      color: #666;
      font-size: 0.85rem;
      margin-bottom: 0.5rem;
    }

    /* ORIGINAL WORKING BLOG CARD STYLES */
    .blog-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
    }

    .blog-card:hover {
      transform: translateY(-14px) scale(1.08);
      box-shadow: 0 30px 70px rgba(0, 0, 0, 0.35);
      background: #fff;
    }

    .blog-image {
      height: 200px;
      background: linear-gradient(45deg, #8fbf8f, #619251);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 2rem;
      font-weight: 700;
      overflow: hidden;
      position: relative;
    }

    .blog-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
    }



    .blog-content {
      padding: 1.5rem;
    }

    .blog-source {
      color: #619251;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .blog-title {
      color: #333;
      font-size: 1.2rem;
      margin-bottom: 1rem;
      line-height: 1.4;
    }

    .blog-excerpt {
      color: #666;
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .read-more {
      color: #619251;
      font-weight: 600;
      transition: color 0.3s ease;
    }

    .read-more:hover {
      color: #4F7942;
    }

    section#about,
    section#contact {
      background: transparent;
      padding: 6rem 1rem;
      color: #fff;
      text-align: center;
    }



    #about p {
      max-width: 800px;
      margin: 0 auto;
      color: #fff;
      line-height: 1.8;
      font-size: 1.1rem;
    }

    .contact-cta {
      font-size: 1.2rem;
      margin-bottom: 2rem;
      font-weight: 300;
    }

    form {
      max-width: 500px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    input,
    textarea {
      padding: 1rem;
      border: none;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.95);
      font-family: inherit;
      transition: all 0.3s ease;
    }

    input:focus,
    textarea:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(97, 146, 81, 0.3);
    }

    button {
      align-self: flex-start;
      font-family: inherit;
      cursor: pointer;
    }

    footer {
      text-align: center;
      font-size: 0.9rem;
      color: #fff;
      padding: 2rem 1rem;
      background: transparent;
    }

    .footer-flex {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
    }

    .footer-links a {
      color: #fff;
      margin: 0 0.25rem;
    }

    .footer-blurb {
      font-size: 0.8rem;
      color: #ddd;
      margin: 0;
    }

    .back-to-top {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background: #619251;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      opacity: 0;
      visibility: hidden;
      z-index: 1000;
    }

    .back-to-top.visible {
      opacity: 1;
      visibility: visible;
    }

    .back-to-top:hover {
      background: #4F7942;
      transform: translateY(-3px);
    }

    /* Cursor Trail Effect */
    .cursor-trail {
      position: fixed;
      width: 6px;
      height: 6px;
      background: rgba(97, 146, 81, 0.8);
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      transition: all 0.1s ease;
    }

    html {
      scroll-behavior: smooth;
    }


    @media (max-width: 768px) {
      .nav-links {
        display: none;
      }

      .hero h1 {
        font-size: 2.5rem;
      }

      .hero .tagline {
        font-size: 1.1rem;
      }

      .hero-buttons {
        flex-direction: column;
        align-items: center;
      }

      .blog-grid {
        grid-template-columns: 1fr;
      }


      .container {
        padding: 0 1rem;
      }

      /* Mobile responsiveness for chat */
      .chat-interface {
        margin: 0 1rem;
      }
      
      .chat-messages {
        height: 300px;
        padding: 1rem;
      }
      
      .message-content {
        max-width: 90%;
      }


  .message-text {
    padding: 0.75rem 1rem;
  }
}
@media (min-width: 769px) {
}
  </style>
</head>

  <div class="loading-screen" id="loadingScreen">
    <div class="loading-content">
      <div class="loading-text">Welcome to Fernly Health</div>
    </div>
  </div>


  <header>
    <div class="container">
      <nav>
        <div class="logo">
          <img src="images/Fernly-logo.png" alt="Fernly Health Logo">
          <span>Fernly Health</span>
        </div>
        <ul class="nav-links">
          <li><a href="#home">Home</a></li>
          <li><a href="#about">About</a></li>
          <li><a href="services.html">Services</a></li>
          <li><a href="team.html">Team</a></li>
          <li><a href="#contact">Contact</a></li>
          <li><a href="login.html">Login</a></li>
          <li><a href="#contact" class="btn-primary">Get Started</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <section id="home" class="hero">
    <div class="container">
      <h1>
        <span class="word" data-word="Recover.">Recover.</span>
        <span class="word" data-word="Rebuild.">Rebuild.</span>
        <span class="word" data-word="Thrive.">Thrive.</span>
      </h1>
      <p class="tagline">Because just 'okay' isn't good enough</p>
      <div class="hero-buttons">
        <a href="#ai-chat" class="btn-ai">Chat with Fernly</a>
        <a href="services.html" class="btn-primary">Our Services</a>
        <a href="#contact" class="btn-secondary">Free Consultation</a>
      </div>
    </div>
  </section>

  <!-- Blank section between hero and how it works -->
  <section class="blank-section"></section>

  <!-- How It Works Stepper Section -->
  <section id="how-it-works" data-aos="fade-up">
    <div class="container">
      <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">How It Works</h2>
      
      <!-- Stepper Navigation -->
      <div class="stepper-nav" role="tablist" aria-label="How It Works Steps">
        <button class="stepper-nav__item stepper-nav__item--active" 
                role="tab" 
                aria-selected="true" 
                aria-controls="step-1-content" 
                id="step-1-tab"
                data-step="1">
          <span class="stepper-nav__number">1</span>
          <span class="stepper-nav__label">Schedule Intake</span>
        </button>
        <button class="stepper-nav__item" 
                role="tab" 
                aria-selected="false" 
                aria-controls="step-2-content" 
                id="step-2-tab"
                data-step="2">
          <span class="stepper-nav__number">2</span>
          <span class="stepper-nav__label">Meet Your Healthcare Team</span>
        </button>
        <button class="stepper-nav__item" 
                role="tab" 
                aria-selected="false" 
                aria-controls="step-3-content" 
                id="step-3-tab"
                data-step="3">
          <span class="stepper-nav__number">3</span>
          <span class="stepper-nav__label">Choose Services</span>
        </button>
        <button class="stepper-nav__item" 
                role="tab" 
                aria-selected="false" 
                aria-controls="step-4-content" 
                id="step-4-tab"
                data-step="4">
          <span class="stepper-nav__number">4</span>
          <span class="stepper-nav__label">Begin Treatment</span>
        </button>
      </div>

      <!-- Step Content Panels -->
      <div class="stepper-content">
        <div class="stepper-content__panel stepper-content__panel--active" 
             role="tabpanel" 
             aria-labelledby="step-1-tab" 
             id="step-1-content">
          <h3 class="stepper-content__title">Schedule Your Intake Appointment</h3>
          <p class="stepper-content__text">Complete our secure online intake form—share your background, goals, and insurance details—then pick an inperson or virtual appointment time that fits your schedule. We’ll confirm your slot right away so you can start without any phone tag or waiting rooms.</p>
          <a href="#contact" class="stepper-content__cta btn-primary">Schedule Now</a>
        </div>
        
        <div class="stepper-content__panel" 
             role="tabpanel" 
             aria-labelledby="step-2-tab" 
             id="step-2-content">
          <h3 class="stepper-content__title">Meet Your Dedicated Healthcare Team</h3>
          <p class="stepper-content__text">Join a 20minute welcome session—either in our bright, Tucson clinic or via HIPAAsecure video—with your care coordinator and boardcertified PMHNP (or therapist). You’ll review your intake, discuss your history, and define clear, personalized treatment goals.</p>
          <a href="team.html" class="stepper-content__cta btn-primary">Meet Our Team</a>
        </div>
        
        <div class="stepper-content__panel" 
             role="tabpanel" 
             aria-labelledby="step-3-tab" 
             id="step-3-content">
          <h3 class="stepper-content__title">Choose Your Treatment Services</h3>
          <p class="stepper-content__text">Browse our full continuum of care: daylong Partial Hospitalization (PHP), threetimesweekly Intensive Outpatient (IOP) groups, individual therapy, medicationassisted treatment (MAT), and skillbuilding workshops. Mix and match inperson or telehealth options to build the plan that’s right for you.</p>
          <a href="services.html" class="stepper-content__cta btn-primary">View Services</a>
        </div>
        
        <div class="stepper-content__panel" 
             role="tabpanel" 
             aria-labelledby="step-4-tab" 
             id="step-4-content">
          <h3 class="stepper-content__title">Begin Your Treatment Journey</h3>
          <p class="stepper-content__text">Kick off your personalized program with scheduled PHP/IOP attendance, oneonone therapy, and regular MAT checkins. You’ll also have 24/7 access to our AI wellness assistant and optional peer support groups, so you’re supported every step of the way.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- AI Chat Section -->

  <section id="ai-chat" data-aos="fade-up">
    <div class="container">
      <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">Ask Away We're Listening</h2>
      <p class="chat-intro" data-aos="fade-up" data-aos-delay="200">Have a quick question about your prescription or wellness plan but can’t make it into the clinic? Fernly AI delivers private, judgment free guidance 24/7 on medications, mental health conditions, and mini wellness check-ins. Just type your question and get clear, expert backed answers in seconds.</p>

      <div class="chat-interface">
        <div class="chat-messages" id="chatMessages">
          <!-- Chat output area for compatibility -->
          <div id="chatOutput" style="display: none;"></div>
          <div class="message bot">
            <div class="message-content">
              <div class="message-text">
                Hi there! I'm here to listen and help. How are you feeling today?
              </div>
            </div>
          </div>
          <!-- AI/Fallback Status Indicator moved below greeting -->
          <div id="aiStatusIndicator" class="ai-status-indicator" style="display: none;">
            <div class="status-content">
              <span class="status-icon">⏳</span>
              <span class="status-text">Loading AI model...</span>
            </div>
          </div>
          <div class="message bot">
            <div class="message-content">
              <div class="message-text">
                <div class="medical-disclaimer">
                  <strong>Wellness Support:</strong> I can provide general information about mental health and medications, and help you explore your wellness concerns. Please consult with a healthcare provider for medical advice.
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="chat-input-area">
          <form id="chatForm">
            <div class="input-container">
              <textarea 
                class="chat-input" 
                id="chatInput" 
                placeholder="Tell me what's on your mind..."
                rows="1"
              ></textarea>
              <button type="submit" class="chat-send" id="chatSend" aria-label="Send message">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
          </form>
          <span id="aiAIStatus" style="font-size:0.9em;color:#888;margin-left:1em;"></span>
          <div class="disclaimer">
            This AI assistant provides general information only. It's not a substitute for professional medical advice. If you're in crisis, please call 988 or seek immediate help.
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="blog" data-aos="fade-up">
    <div class="container">
      <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">Mental Health Resources</h2>
      <div class="resource-description" data-aos="fade-up" data-aos-delay="150">
        Whether you’re seeking practical self care tips, evidence based strategies, or expert insights, our hand picked articles and guides are here to help you build resilience, manage stress, and take charge of your well being. We refresh this collection every month with the latest research and actionable techniques. Dive in and start thriving today!
      </div>
      <div class="blog-grid">
        <div class="blog-card" data-aos="fade-up" data-aos-delay="200">
          <div class="blog-image">
            <img src="Images2/pexels-alexander-mass-748453803-31053876.jpg" alt="Mental Health Resources">
          </div>
          <div class="blog-content">
            <div class="blog-source">Psychology Today</div>
            <div class="blog-date"></div>
            <h3 class="blog-title">What to Do When Your Anxiety Won't Go Away</h3>
            <p class="blog-excerpt">A practical guide to calming persistent anxiety using simple, everyday strategies rooted in mindfulness and selfcare.</p>
            <a href="https://www.psychologytoday.com/us/blog/anxiety-zen/201505/what-do-when-your-anxiety-won-t-go-away" target="_blank" class="read-more">Read More →</a>
          </div>
        </div>
        <div class="blog-card" data-aos="fade-up" data-aos-delay="300">
          <div class="blog-image">
            <img src="Images2/pexels-diva-plavalaguna-5710721.jpg" alt="Mental Health Resources">
          </div>
          <div class="blog-content">
            <div class="blog-source">American Psychological Association</div>
            <div class="blog-date"></div>
            <h3 class="blog-title">The Science of Resilience: Building Mental Strength</h3>
            <p class="blog-excerpt">Evidencebased strategies for developing psychological resilience and coping mechanisms in challenging times.</p>
            <a href="https://www.apa.org/topics/resilience" target="_blank" class="read-more">Read More →</a>
          </div>
        </div>
        <div class="blog-card" data-aos="fade-up" data-aos-delay="400">
          <div class="blog-image">
            <img src="Images2/pexels-jishu-shill-17629318-10634925.jpg" alt="Mental Health Resources">
          </div>
          <div class="blog-content">
            <div class="blog-source">PsychCentral</div>
            <div class="blog-date"></div>
            <h3 class="blog-title">Mindfulness and Recovery: A Holistic Approach</h3>
            <p class="blog-excerpt">How mindfulness practices can enhance traditional therapy and support longterm mental health recovery.</p>
            <a href="https://psychcentral.com/blog/mindfulness-in-mental-health-recovery" target="_blank" class="read-more">Read More →</a>
          </div>
        </div>
        <div class="blog-card" data-aos="fade-up" data-aos-delay="500">
          <div class="blog-image">
            <img src="Images2/pexels-katerina-holmes-5910849.jpg" alt="Mental Health Resources">
          </div>
          <div class="blog-content">
            <div class="blog-source">PsyPost</div>
            <div class="blog-date"></div>
            <h3 class="blog-title">Latest Research on Depression Treatment</h3>
            <p class="blog-excerpt">New findings on personalized treatment approaches and the role of genetics in depression management.</p>
            <a href="https://www.psypost.org/category/mental-health/depression/" target="_blank" class="read-more">Read More →</a>
          </div>
        </div>
        <div class="blog-card" data-aos="fade-up" data-aos-delay="600">
          <div class="blog-image">
            <img src="Images2/pexels-nicola-barts-7943965.jpg" alt="Mental Health Resources">
          </div>
          <div class="blog-content">
            <div class="blog-source">Verywell Mind</div>
            <div class="blog-date"></div>
            <h3 class="blog-title">8 Ways to Provide Emotional Support for Your Partner</h3>
            <p class="blog-excerpt">Practical, emotionally grounded tips—like active listening, meaningful gestures, and emotional validation—to help partners feel seen, heard, and supported during tough times.</p>
            <a href="https://www.verywellmind.com/how-to-provide-emotional-support-for-your-partner-7505967" target="_blank" class="read-more">Read More →</a>
          </div>
        </div>
        <div class="blog-card" data-aos="fade-up" data-aos-delay="700">
          <div class="blog-image">
            <img src="Images2/pexels-tuan-pm-1320993433-29133902.jpg" alt="Mental Health Resources">
          </div>
          <div class="blog-content">
            <div class="blog-source">MedlinePlus</div>
            <div class="blog-date"></div>
            <h3 class="blog-title">Psychiatric Medications Guide</h3>
            <p class="blog-excerpt">Comprehensive information about mental health conditions, symptoms, and treatment approaches for various psychological wellbeing concerns.</p>
            <a href="https://medlineplus.gov/mentalhealthmedicines.html" target="_blank" class="read-more">Read More →</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="about" data-aos="fade-up">
    <div class="container">
      <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">Reclaim Your Well Being with Fernly Health</h2>
      <p data-aos="fade-up" data-aos-delay="200">At Fernly Health, we partner with you every step of your mental health and recovery journey. Helping you heal, grow, and reclaim balance. Our Arizona wide team of board certified psychiatrists, psychologists, therapists, and psychiatric nurse practitioners deliver compassionate, evidence based care in person or online. Ready to take the first step? Visit us today.</p>
    </div>
  </section>

  <section id="contact" data-aos="fade-up">
    <div class="container">
      <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">Contact Us</h2>
      <p class="contact-cta" data-aos="fade-up" data-aos-delay="200">Reach out for a free consultation – your healing starts here.</p>
      <form id="contactForm">
        <input type="text" placeholder="Name" required>
        <input type="email" placeholder="Email" required>
        <textarea rows="4" placeholder="How can we help?" required></textarea>
        <button type="submit" class="btn-primary">Send Message</button>
      </form>
    </div>
  </section>

  <!-- Chat Bubble Component -->
  <div class="chat-bubble" id="chatBubble" aria-hidden="true">
    <div class="chat-bubble__content">
      <div class="chat-bubble__text">Not sure where to begin? Start here.</div>
      <div class="chat-bubble__actions">
        <a href="services.html" class="chat-bubble__link">View Services</a>
        <a href="#contact" class="chat-bubble__link">Book Consultation</a>
      </div>
    </div>
    <button class="chat-bubble__close" aria-label="Close chat bubble">&times;</button>
  </div>

  <footer>
    <div class="container footer-flex">
      <div class="footer-links">
        <a href="privacy.html" target="_blank">Privacy Policy</a> |
        <a href="#">Careers</a>
      </div>
      <p class="footer-blurb">Proudly serving Phoenix, Tucson and communities across Arizona.</p>
      <p>&copy; 2025 Fernly Health. All rights reserved.</p>
    </div>
  </footer>

  <!-- Back to Top Button -->
  <button type="button" id="backToTop" class="back-to-top" aria-label="Back to top">↑</button>

  <!-- JAVASCRIPT WILL GO HERE -->
  <script>
// Initialize loading screen and AI
  window.addEventListener('load', () => {
    // AI system loads from ai.js with pattern-based responses
    console.log('Smart AI system initialized');
    if (typeof updateAIStatusIndicator === 'function') {
      updateAIStatusIndicator('ai-active', 'Smart AI Active');
    }

  setTimeout(() => {
    document.getElementById('loadingScreen').classList.add('fade-out');
    
    // Start hero words animation immediately as fade-out begins for seamless transition
    const logo = document.querySelector('.logo');
    if (logo) logo.classList.add('start-animation');
    startHeroWordsAnimation();
    
    // Initialize AI and hide loading screen after fade completes
    setTimeout(async () => {
      document.getElementById('loadingScreen').style.display = 'none';
      if (typeof initializeAIChat === 'function') {
        await initializeAIChat();
      }
    }, 1000);
  }, 3000);
});

// Smooth scrolling
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function(e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute('href'));
    if (target) {
      target.scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
    }
  });
});

// Navbar scroll effect
window.addEventListener('scroll', function() {
  const header = document.querySelector('header');
  if (window.scrollY > 100) {
    header.style.background = 'rgba(255,255,255,0.98)';
  } else {
    header.style.background = 'rgba(255,255,255,0.95)';
  }
});

// Back to top button
const backToTopBtn = document.getElementById('backToTop');
window.addEventListener('scroll', function() {
  if (window.scrollY > 300) {
    backToTopBtn.classList.add('visible');
  } else {
    backToTopBtn.classList.remove('visible');
  }
});

backToTopBtn.addEventListener('click', function() {
  window.scrollTo({
    top: 0,
    behavior: 'smooth'
  });
});

// Hero words animation sequence
function startHeroWordsAnimation() {
  const words = document.querySelectorAll('.hero h1 .word');
  words.forEach(word => {
    word.style.animationPlayState = 'running';
  });

  // Show tagline once the last word finishes
  setTimeout(() => {
    const tagline = document.querySelector('.hero .tagline');
    if (tagline) {
      tagline.classList.add('show');
    }
  }, 2700);
}

// Tagline animation - now handled by startHeroWordsAnimation()
// setTimeout(() => {
//   const tagline = document.querySelector('.hero .tagline');
//   tagline.classList.add('show');
// }, 5000);


// Cursor trail effect
let cursorTrails = [];
const maxTrails = 20;

document.addEventListener('mousemove', function(e) {
  const trail = document.createElement('div');
  trail.className = 'cursor-trail';
  trail.style.left = e.pageX - 3 + 'px';
  trail.style.top = e.pageY - 3 + 'px';
  document.body.appendChild(trail);

  cursorTrails.push(trail);

  if (cursorTrails.length > maxTrails) {
    const oldTrail = cursorTrails.shift();
    if (oldTrail && oldTrail.parentNode) {
      oldTrail.parentNode.removeChild(oldTrail);
    }
  }

  setTimeout(() => {
    if (trail.parentNode) {
      trail.style.opacity = '0';
      trail.style.transform = 'scale(0.5)';
      setTimeout(() => {
        if (trail.parentNode) {
          trail.parentNode.removeChild(trail);
        }
      }, 200);
    }
  }, 100);
});

// AI Chatbot Functionality for the new interface
const chatMessages = document.getElementById('chatMessages');
const chatInput = document.getElementById('chatInput');
const chatSend = document.getElementById('chatSend');

// Auto-resize textarea
chatInput.addEventListener('input', () => {
  chatInput.style.height = 'auto';
  chatInput.style.height = Math.min(chatInput.scrollHeight, 120) + 'px';
});

// Send message on Enter key (but allow Shift+Enter for new lines)
chatInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

// Send message on button click
chatSend.addEventListener('click', sendMessage);

// Handle form submission
document.getElementById('chatForm').addEventListener('submit', function(e) {
  e.preventDefault();
  sendMessage();
});

// Enhanced message sending function with AI and realistic timing
async function sendMessage() {
  const message = chatInput.value.trim();
  if (!message) return;

  // Disable send button and input
  chatSend.disabled = true;
  chatInput.disabled = true;

  // Add user message
  addMessage(message, 'user');
  chatInput.value = '';
  chatInput.style.height = 'auto';

  // Show typing indicator
  const typingIndicator = addTypingIndicator();
  
  // Add small realistic delay before processing (100-300ms)
  const processingDelay = 100 + Math.random() * 200;
  
  await new Promise(resolve => setTimeout(resolve, processingDelay));
  
  try {
    // Generate response using mental health AI system
    const aiResponse = await window.generateAIResponse(message);

    // Remove typing indicator and add AI response
    if (typingIndicator && typingIndicator.parentNode) {
      chatMessages.removeChild(typingIndicator);
    }

    // Check if this is a "thinking" message
    if (aiResponse && (aiResponse.includes('Let me think') || aiResponse.includes('considering') || aiResponse.includes('reflect'))) {
      // Add the thinking message
      addMessage(aiResponse, 'bot');
      
      // Don't re-enable inputs yet, wait for the actual response
      // The generateAIResponse function will handle the delayed actual response
      return;
    }

    addMessage(aiResponse, 'bot');
  } catch (error) {
    console.error('Error generating response:', error);
    if (typingIndicator && typingIndicator.parentNode) {
      chatMessages.removeChild(typingIndicator);
    }
    
    // Fallback to basic response if AI fails
    const fallbackResponse = "I'm here to listen and support you. Could you tell me more about what's on your mind?";
    addMessage(fallbackResponse, 'bot');
  } finally {
    // Re-enable send button and input
    chatSend.disabled = false;
    chatInput.disabled = false;
    chatInput.focus();
  }
}

// Enhanced message display function
function addMessage(text, type) {
  const messageDiv = document.createElement('div');
  messageDiv.className = `message ${type}`;
  
  // Check if the message contains HTML (for resource cards)
  if (text.includes('<div class="medication-info">') || text.includes('<div class="wellness-assessment">') || text.includes('<div class="resource-card">')) {
    messageDiv.innerHTML = `
      <div class="message-content">
        <div class="message-text">${text}</div>
      </div>
    `;
  } else {
    messageDiv.innerHTML = `
      <div class="message-content">
        <div class="message-text">${text}</div>
      </div>
    `;
  }
  
  chatMessages.appendChild(messageDiv);
  chatMessages.scrollTop = chatMessages.scrollHeight;
  return messageDiv;
}

// Typing indicator function
function addTypingIndicator() {
  const messageDiv = document.createElement('div');
  messageDiv.className = 'message bot';
  
  messageDiv.innerHTML = `
    <div class="message-content">
      <div class="typing-indicator">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  `;
  
  chatMessages.appendChild(messageDiv);
  chatMessages.scrollTop = chatMessages.scrollHeight;
  return messageDiv;
}

// Contact form submission
document.getElementById('contactForm').addEventListener('submit', function(e) {
  e.preventDefault();
  alert('Thank you for your message! We\'ll get back to you soon.');
  this.reset();
});


</script>

<script type="module">
// Update status to indicate mental health AI is active
if (document.getElementById('aiAIStatus')) {
  document.getElementById('aiAIStatus').innerText = 'Mental Health AI Active';
}
</script>

<!-- How It Works Stepper Component JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const stepperNavItems = document.querySelectorAll('.stepper-nav__item');
  const stepperPanels = document.querySelectorAll('.stepper-content__panel');
  
  // Initialize stepper functionality
  function initializeStepper() {
    stepperNavItems.forEach((item, index) => {
      item.addEventListener('click', function() {
        activateStep(index + 1);
      });
      
      // Add keyboard navigation
      item.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          activateStep(index + 1);
        }
        
        // Arrow key navigation
        if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
          e.preventDefault();
          const direction = e.key === 'ArrowLeft' ? -1 : 1;
          const newIndex = index + direction;
          
          if (newIndex >= 0 && newIndex < stepperNavItems.length) {
            stepperNavItems[newIndex].focus();
            activateStep(newIndex + 1);
          }
        }
      });
    });
  }
  
  // Activate a specific step
  function activateStep(stepNumber) {
    // Update nav items
    stepperNavItems.forEach((item, index) => {
      const isActive = index + 1 === stepNumber;
      item.classList.toggle('stepper-nav__item--active', isActive);
      item.setAttribute('aria-selected', isActive);
    });
    
    // Update panels with smooth transition
    stepperPanels.forEach((panel, index) => {
      const isActive = index + 1 === stepNumber;
      
      if (isActive) {
        panel.classList.add('stepper-content__panel--active');
        panel.setAttribute('aria-hidden', 'false');
      } else {
        panel.classList.remove('stepper-content__panel--active');
        panel.setAttribute('aria-hidden', 'true');
      }
    });
  }
  
  // Initialize the stepper
  initializeStepper();
});
</script>

<!-- Chat Bubble Component JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const chatBubble = document.getElementById('chatBubble');
  const chatBubbleClose = document.querySelector('.chat-bubble__close');
  let chatBubbleTimer;
  let isUserInteracting = false;
  let chatBubbleShown = false;
  
  // Check if we're on a page with AI chat functionality
  function isAIChatActive() {
    const chatInterface = document.querySelector('.chat-interface');
    const chatInput = document.getElementById('chatInput');
    
    // Check if chat interface exists and if user is actively typing
    if (chatInterface && chatInput) {
      return chatInput === document.activeElement || 
             chatInput.value.length > 0 ||
             document.querySelector('.message.user'); // Check if user has sent messages
    }
    return false;
  }
  
  // Show chat bubble
  function showChatBubble() {
    if (!chatBubbleShown && !isAIChatActive()) {
      chatBubble.classList.add('chat-bubble--visible');
      chatBubble.setAttribute('aria-hidden', 'false');
      chatBubbleShown = true;
    }
  }
  
  // Hide chat bubble
  function hideChatBubble() {
    chatBubble.classList.remove('chat-bubble--visible');
    chatBubble.setAttribute('aria-hidden', 'true');
    chatBubbleShown = false;
  }
  
  // Start timer for chat bubble
  function startChatBubbleTimer() {
    clearTimeout(chatBubbleTimer);
    chatBubbleTimer = setTimeout(() => {
      if (!isUserInteracting && !isAIChatActive()) {
        showChatBubble();
      }
    }, 60000); // 1 minute
  }
  
  // Reset timer on user interaction
  function resetChatBubbleTimer() {
    isUserInteracting = true;
    hideChatBubble();
    clearTimeout(chatBubbleTimer);
    
    // Reset interaction flag after a short delay
    setTimeout(() => {
      isUserInteracting = false;
      // Only restart timer if we're still in the hero section
      if (isInHeroSection()) {
        startChatBubbleTimer();
      }
    }, 2000);
  }
  
  // Check if user is in hero section
  function isInHeroSection() {
    const heroSection = document.getElementById('home');
    if (!heroSection) return false;
    
    const heroRect = heroSection.getBoundingClientRect();
    const viewportHeight = window.innerHeight;
    
    // Consider user in hero section if hero is visible in viewport
    return heroRect.top < viewportHeight && heroRect.bottom > 0;
  }
  
  // Handle scroll events
  function handleScroll() {
    resetChatBubbleTimer();
    
    // Hide chat bubble if user scrolls past hero section
    if (!isInHeroSection()) {
      hideChatBubble();
      clearTimeout(chatBubbleTimer);
    }
  }
  
  // Initialize chat bubble functionality
  function initializeChatBubble() {
    // Close button functionality
    chatBubbleClose.addEventListener('click', function() {
      hideChatBubble();
      clearTimeout(chatBubbleTimer);
    });
    
    // Start timer when page loads if in hero section
    if (isInHeroSection()) {
      startChatBubbleTimer();
    }
    
    // Listen for scroll events
    window.addEventListener('scroll', handleScroll, { passive: true });
    
    // Listen for mouse movement and keyboard activity
    document.addEventListener('mousemove', resetChatBubbleTimer, { passive: true });
    document.addEventListener('keydown', resetChatBubbleTimer, { passive: true });
    document.addEventListener('click', resetChatBubbleTimer, { passive: true });
    
    // Hide chat bubble when AI chat is being used
    const chatInput = document.getElementById('chatInput');
    if (chatInput) {
      chatInput.addEventListener('focus', hideChatBubble);
      chatInput.addEventListener('input', hideChatBubble);
    }
  }
  
  // Initialize the chat bubble
  initializeChatBubble();
});
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const dateEls = document.querySelectorAll('.blog-date');
    const now = new Date();
    const monthYear = now.toLocaleString('default', { month: 'long', year: 'numeric' });
    dateEls.forEach(el => {
      el.textContent = 'Last updated ' + monthYear;
    });
  });
</script>

<!-- AOS (Animate On Scroll) JavaScript -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
  // Initialize AOS with custom settings
  AOS.init({
    duration: 800,
    easing: 'ease-out',
    once: true,
    offset: 100,
    disable: false
  });
</script>
</body>

</html>

